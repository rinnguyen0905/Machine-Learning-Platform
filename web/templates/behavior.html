<!DOCTYPE html>
<html lang="vi">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Đánh giá Khách hàng hiện tại | Credit Scoring Platform</title>
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css">
    <link rel="stylesheet" href="{{ url_for('static', filename='css/styles.css') }}">
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
</head>
<body>
    <!-- Same navbar as index.html -->
    <nav class="navbar navbar-expand-lg navbar-dark bg-primary">
        <div class="container">
            <a class="navbar-brand" href="/">
                <img src="{{ url_for('static', filename='img/ML_Platform_icon.png') }}" alt="Logo" width="30" height="30" class="d-inline-block align-text-top me-2">
                Credit Scoring Platform
            </a>
            <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarNav">
                <span class="navbar-toggler-icon"></span>
            </button>
            <div class="collapse navbar-collapse" id="navbarNav">
                <ul class="navbar-nav">
                    <li class="nav-item">
                        <a class="nav-link" href="/">Home</a>
                    </li>
                    <li class="nav-item">
                        <a class="nav-link" href="/dashboard">Dashboard</a>
                    </li>
                    <li class="nav-item">
                        <a class="nav-link" href="/application">Application Score</a>
                    </li>
                    <li class="nav-item">
                        <a class="nav-link active" href="/behavior">Behavior Score</a>
                    </li>
                    <li class="nav-item">
                        <a class="nav-link" href="/collections">Collections</a>
                    </li>
                    <li class="nav-item">
                        <a class="nav-link" href="/desertion">Desertion</a>
                    </li>
                    <li class="nav-item">
                        <a class="nav-link" href="/batch">Batch Processing</a>
                    </li>
                </ul>
            </div>
        </div>
    </nav>

    <div class="container mt-4">
        <h1 class="mb-4">Behavior Score</h1>
        
        <div class="row">
            <div class="col-md-5">
                <div class="card">
                    <div class="card-header">
                        <h5>Thông tin hành vi</h5>
                    </div>
                    <div class="card-body">
                        <form id="behaviorForm">
                            <div class="mb-3">
                                <label for="customer_id" class="form-label">ID khách hàng</label>
                                <input type="text" class="form-control" id="customer_id" required>
                            </div>
                            <div class="mb-3">
                                <label for="current_balance" class="form-label">Số dư hiện tại</label>
                                <input type="number" class="form-control" id="current_balance" min="0" required>
                            </div>
                            <div class="mb-3">
                                <label for="average_monthly_payment" class="form-label">Thanh toán trung bình hàng tháng</label>
                                <input type="number" class="form-control" id="average_monthly_payment" min="0" required>
                            </div>
                            <div class="mb-3">
                                <label for="payment_ratio" class="form-label">Tỷ lệ thanh toán</label>
                                <input type="number" class="form-control" id="payment_ratio" min="0" max="1" step="0.01" required>
                            </div>
                            <div class="mb-3">
                                <label for="number_of_late_payments" class="form-label">Số lần thanh toán trễ</label>
                                <input type="number" class="form-control" id="number_of_late_payments" min="0" required>
                            </div>
                            <div class="mb-3">
                                <label for="months_since_last_late_payment" class="form-label">Số tháng từ lần trễ gần nhất</label>
                                <input type="number" class="form-control" id="months_since_last_late_payment" min="0" required>
                            </div>
                            <div class="mb-3">
                                <label for="number_of_credit_inquiries" class="form-label">Số lần truy vấn tín dụng</label>
                                <input type="number" class="form-control" id="number_of_credit_inquiries" min="0" required>
                            </div>
                            <div class="mb-3">
                                <label for="current_limit" class="form-label">Hạn mức hiện tại</label>
                                <input type="number" class="form-control" id="current_limit" min="0" required>
                            </div>
                            <div class="mb-3">
                                <label for="average_utilization" class="form-label">Mức sử dụng trung bình</label>
                                <input type="number" class="form-control" id="average_utilization" min="0" max="1" step="0.01" required>
                            </div>
                            <button type="submit" class="btn btn-primary">Đánh giá</button>
                            <button type="button" class="btn btn-outline-secondary" id="loadSample">Tải mẫu</button>
                        </form>
                    </div>
                </div>
            </div>
            
            <div class="col-md-7">
                <div class="card mb-4" id="resultCard" style="display: none;">
                    <div class="card-header bg-primary text-white">
                        <h5>Kết quả đánh giá</h5>
                    </div>
                    <div class="card-body">
                        <div class="text-center mb-4">
                            <h3 id="creditScore">---</h3>
                            <div class="progress" style="height: 25px;">
                                <div class="progress-bar" id="scoreProgressBar" role="progressbar" style="width: 0%"></div>
                            </div>
                            <div class="d-flex justify-content-between mt-1">
                                <small>300</small>
                                <small>850</small>
                            </div>
                        </div>
                        
                        <div class="row">
                            <div class="col-md-6">
                                <h5>Đề xuất hạn mức</h5>
                                <table class="table table-sm">
                                    <tbody>
                                        <tr>
                                            <td>Hạn mức hiện tại:</td>
                                            <td id="currentLimit">---</td>
                                        </tr>
                                        <tr>
                                            <td>Hạn mức đề xuất:</td>
                                            <td id="suggestedLimit">---</td>
                                        </tr>
                                        <tr>
                                            <td>Thay đổi:</td>
                                            <td id="limitChange">---</td>
                                        </tr>
                                    </tbody>
                                </table>
                            </div>
                            <div class="col-md-6">
                                <h5>Đánh giá rủi ro</h5>
                                <table class="table table-sm">
                                    <tbody>
                                        <tr>
                                            <td>Mức độ rủi ro:</td>
                                            <td><span id="riskLevel" class="badge rounded-pill"></span></td>
                                        </tr>
                                        <tr>
                                            <td>Xác suất vỡ nợ:</td>
                                            <td id="defaultProbability">---</td>
                                        </tr>
                                        <tr>
                                            <td>Đề xuất:</td>
                                            <td><span id="suggestedAction" class="badge rounded-pill"></span></td>
                                        </tr>
                                    </tbody>
                                </table>
                            </div>
                        </div>
                        
                        <div class="mt-3">
                            <h5>Yếu tố rủi ro chính</h5>
                            <ul class="list-group list-group-flush" id="riskFactorsList">
                                <!-- Will be filled by JS -->
                            </ul>
                        </div>
                    </div>
                </div>
                
                <div class="card" id="aboutCard">
                    <div class="card-header">
                        <h5>Về Behavior Scorecard</h5>
                    </div>
                    <div class="card-body">
                        <p>
                            Behavior Scorecard đánh giá rủi ro của khách hàng hiện tại dựa trên hành vi sử dụng tín dụng.
                            Mô hình phân tích lịch sử thanh toán, mức sử dụng tín dụng, và các yếu tố hành vi khác để
                            đề xuất giới hạn tín dụng phù hợp và đưa ra điểm tín dụng cập nhật.
                        </p>
                        <p>
                            Dựa vào kết quả đánh giá, hệ thống sẽ đề xuất một trong các hành động:
                        </p>
                        <ul>
                            <li>Tăng hạn mức: Dành cho khách hàng có hành vi tốt và rủi ro thấp</li>
                            <li>Giữ nguyên hạn mức: Dành cho khách hàng có rủi ro trung bình</li>
                            <li>Giảm hạn mức: Dành cho khách hàng có dấu hiệu rủi ro gia tăng</li>
                        </ul>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <footer class="bg-light py-4 mt-5">
        <div class="container text-center">
            <p>&copy; 2025 Credit Scoring Platform. All rights reserved. Huy Nguyen Quoc</p>
        </div>
    </footer>

    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
    <script src="{{ url_for('static', filename='js/api.js') }}"></script>
    <script src="{{ url_for('static', filename='js/behavior.js') }}"></script>
</body>
</html>
